groups:
- name: habrio_slo
  rules:
  - alert: HighRequestLatency
    expr: histogram_quantile(0.99, sum(rate(flask_http_request_duration_seconds_bucket[5m])) by (le)) > 0.5
    for: 2m
    labels:
      severity: page
    annotations:
      summary: "99th percentile request latency too high"
  - alert: HighDbLatency
    expr: histogram_quantile(0.99, sum(rate(db_query_duration_seconds_bucket[5m])) by (le)) > 0.1
    for: 2m
    labels:
      severity: page
    annotations:
      summary: "99th percentile DB query latency too high"
  - alert: HighErrorRate
    expr: sum(rate(flask_error_total[5m])) / sum(rate(flask_http_request_total[5m])) > 0.05
    for: 5m
    labels:
      severity: page
    annotations:
      summary: "More than 5% of requests return errors"
